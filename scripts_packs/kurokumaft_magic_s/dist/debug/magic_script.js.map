{"version":3,"sources":["../../scripts/magic_script.ts","../../scripts/shieldEvent.ts","../../scripts/common/commonUtil.ts","../../scripts/magicItem.ts","../../scripts/magic/MagicBookComponent.ts","../../scripts/magicBlock.ts","../../scripts/magic/GrimoireBookComponent.ts","../../scripts/magic/MagicStoneComponet.ts","../../scripts/magic/magicAmorEvent.ts","../../scripts/magic/imperial.ts","../../scripts/custom/ShooterMagicEvent.ts","../../scripts/common/ShooterPoints.ts","../../scripts/common/ItemDurabilityDamage.ts","../../scripts/weapon/wand/FireMagicWand.ts","../../scripts/custom/CustomComponentRegistry.ts"],"sourcesContent":["import { world,system,EntityComponentTypes,EquipmentSlot, Entity, Player, EntityEquippableComponent, EntityDamageSource } from \"@minecraft/server\";\r\nimport { shieldGuard, shieldCounter } from \"./shieldEvent\";\r\nimport { print, playsound, durabilityDamage, breakItem } from \"./common/commonUtil\";\r\nimport { home_tp, homeSetDialog, torchlight_use, ignited_use_af, ignited_use_be, water_use, flower_garden_use, growth_use, mowing_use, music_sound_use, \r\n    grimoire_summon_use, grimoire_summon_Release } from \"./magicItem\";\r\nimport { magic_lectern, magic_lectern_break } from \"./magicBlock\";\r\nimport { magicAmor } from \"./magic/magicAmorEvent\";\r\nimport { fireStorm } from \"./magic/imperial\";\r\nimport { registerCustomComponentFunction } from \"./custom/CustomComponentRegistry\";\r\n\r\nconst guards = [\"anvil\", \"blockExplosion\", \"entityAttack\", \"entityExplosion\", \"sonicBoom\", \"projectile\"];\r\n\r\n// ワールド接続時\r\nworld.beforeEvents.worldInitialize.subscribe(initEvent => {\r\n    registerCustomComponentFunction(initEvent);\r\n});\r\n\r\n// エンティティを右クリック\r\n// world.afterEvents.playerInteractWithEntity.subscribe(event => {\r\n//     var player = event.player;\r\n//     var target = event.target;\r\n//     var item = event.itemStack;\r\n//     if (item) {\r\n//         if (item.typeId == \"kurokumaft:repatriation_fruit\" && target.typeId == \"kurokumaft:home_gate\") {\r\n//             homeSetDialog(player, item, target);\r\n//         }\r\n//     }\r\n//     if (target.typeId == \"kurokumaft:fire_magic_sword\") {\r\n//         // print(target.typeId);\r\n//     }\r\n\r\n// });\r\n\r\n// 近接hit後\r\nworld.afterEvents.entityHitEntity.subscribe(event => {\r\n    var dameger = event.damagingEntity as Entity;\r\n    var hitEn = event.hitEntity as Entity;\r\n    if (hitEn.typeId == \"minecraft:player\") {\r\n        shieldGuard(hitEn as Player, true);\r\n        shieldCounter(hitEn as Player, dameger);\r\n        magicAmor(hitEn as Player, dameger, undefined, undefined);\r\n    }\r\n    // let equ = dameger.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n    // let mainItem = equ.getEquipment(EquipmentSlot.Mainhand);\r\n    // if (mainItem && mainItem.typeId.indexOf(\"magic_sword\")) {\r\n\r\n    // }\r\n\r\n});\r\n// 遠距離hit後\r\nworld.afterEvents.projectileHitEntity.subscribe(event => {\r\n    var projectileEn = event.projectile;\r\n    var hitEn = event.getEntityHit().entity as Entity;\r\n    var dameger = event.source as Entity;\r\n    var hitVector = event.hitVector;\r\n    if (hitEn != undefined && hitEn.typeId == \"minecraft:player\") {\r\n        shieldGuard(hitEn as Player, false);\r\n        shieldCounter(hitEn as Player, dameger);\r\n        magicAmor(hitEn as Player,dameger,projectileEn, hitVector);\r\n    }\r\n    if (projectileEn) {\r\n        if (projectileEn.typeId == \"kurokumaft:firestormmagic\") {\r\n            fireStorm(event.dimension, event.location);\r\n        }\r\n    }\r\n});\r\n\r\n// ブロックhit後\r\nworld.afterEvents.projectileHitBlock.subscribe(event => {\r\n    var projectileEn = event.projectile;\r\n    if (projectileEn) {\r\n        if (projectileEn.typeId == \"kurokumaft:firestormmagic\") {\r\n            fireStorm(event.dimension, event.location);\r\n        }\r\n    }\r\n});\r\n\r\n// ダメージ\r\nworld.afterEvents.entityHurt.subscribe(event => {\r\n    if (event) {\r\n        var damageSource = event.damageSource as EntityDamageSource;\r\n        var hitEn = event.hurtEntity as Entity;\r\n        // print(hitEn, damageSource.cause + \"=\" + damage);\r\n        if (hitEn != undefined && hitEn.typeId == \"minecraft:player\" && damageSource.cause != \"void\") {\r\n            if (guards.indexOf(damageSource.cause) != -1) {\r\n                shieldGuard(hitEn as Player, false);\r\n            }\r\n        }\r\n    }\r\n});\r\n\r\n// アイテム使用完了\r\nworld.afterEvents.itemCompleteUse.subscribe(event => {\r\n    var en = event.source;\r\n    var item = event.itemStack;\r\n    if (en != undefined && en.typeId == \"minecraft:player\" && item != undefined ) {\r\n        if (item.typeId === \"kurokumaft:repatriation_fruit\") {\r\n            home_tp(en, item)\r\n        }\r\n    }\r\n});\r\n\r\n// ブロックアイテム右クリック後\r\n// world.afterEvents.playerInteractWithBlock.subscribe(event => {\r\n//     var player = event.player;\r\n//     var item = event.itemStack;\r\n//     var block = event.block;\r\n//     // print(\"playerInteractWithBlock\");\r\n//     if (player != undefined) {\r\n//         if (block.typeId == \"kurokumaft:magic_lectern\") {\r\n//             magic_lectern(player, item, block);\r\n//         }\r\n//     }\r\n// });\r\n\r\n// アイテム右クリック後\r\nworld.afterEvents.itemUse.subscribe(event => {\r\n    var player = event.source;\r\n    var item = event.itemStack;\r\n    // print(\"itemUse\");\r\n    if (item != undefined) {\r\n        // print(item.typeId);\r\n        if (item.typeId == \"kurokumaft:grimoire_mowing\") {\r\n            mowing_use(player, item);\r\n        } else if (item.typeId == \"kurokumaft:grimoire_music_sound\") {\r\n            music_sound_use(player, item);\r\n        } else if (item.typeId == \"kurokumaft:fire_grimoire\") {\r\n            grimoire_summon_use(player, item);\r\n        }\r\n    }\r\n});\r\n\r\n// アイテム右クリックリリース後\r\nworld.afterEvents.itemReleaseUse.subscribe(event => {\r\n    var player = event.source;\r\n    var item = event.itemStack;\r\n    var duration = event.useDuration;\r\n    // print(\"itemReleaseUse\");\r\n    if (item != undefined) {\r\n        // print(item.typeId);\r\n        // print(duration);\r\n        if (item.typeId == \"kurokumaft:fire_grimoire\") {\r\n            grimoire_summon_Release(player, item, duration);\r\n        }\r\n    }\r\n});\r\n\r\n// ブロック右クリック後\r\nworld.afterEvents.itemUseOn.subscribe(event => {\r\n    var player = event.source;\r\n    var item = event.itemStack;\r\n    var block = event.block;\r\n    var blockFace = event.blockFace;\r\n    // print(\"itemUseOnAf\");\r\n    // print(block.typeId);\r\n    if (item != undefined) {\r\n        if (item.typeId == \"kurokumaft:grimoire_torchlight\") {\r\n            torchlight_use(player, block, item);\r\n        } else if (item.typeId == \"kurokumaft:grimoire_ignited\") {\r\n            ignited_use_af(player, block, blockFace, item);\r\n        } else if (item.typeId == \"kurokumaft:grimoire_water\") {\r\n            water_use(player, block, blockFace, item);\r\n        } else if (item.typeId == \"kurokumaft:grimoire_flower_garden\") {\r\n            flower_garden_use(player, block, blockFace, item);\r\n        } else if (item.typeId == \"kurokumaft:grimoire_growth\") {\r\n            growth_use(player, block, blockFace, item);\r\n        }\r\n    }\r\n});\r\n\r\n// ブロック右クリック前\r\nworld.beforeEvents.itemUseOn.subscribe(event => {\r\n    var player = event.source;\r\n    var item = event.itemStack;\r\n    var block = event.block;\r\n    var blockFace = event.blockFace;\r\n    // print(\"itemUseOnBe\");\r\n    // print(block.typeId);\r\n    // print(item.typeId);\r\n    if (item != undefined) {\r\n        if (block.typeId != \"minecraft:tnt\" && item.typeId == \"kurokumaft:grimoire_ignited\") {\r\n            ignited_use_be(player, block, blockFace, item);\r\n        }\r\n    }\r\n});\r\n\r\n// ブロック破壊前\r\nworld.beforeEvents.playerBreakBlock.subscribe(event => {\r\n    var player = event.player;\r\n    var block = event.block;\r\n    // print(\"playerBreakBlock\");\r\n    if (player != undefined) {\r\n        // print(block.typeId);\r\n        if (block.typeId == \"kurokumaft:magic_lectern\") {\r\n            magic_lectern_break(player, block);\r\n        }\r\n    }\r\n});\r\n\r\n// エンティティ読み込み\r\nworld.afterEvents.entityLoad.subscribe(event => {\r\n    var entity = event.entity;\r\n});\r\n\r\n// エンティティスポーン\r\nworld.afterEvents.entitySpawn.subscribe(event => {\r\n    // print(\"entitySpawn\");\r\n    var entity = event.entity;\r\n    var cause = event.cause;\r\n    // print(entity.typeId);\r\n    // print(cause);\r\n});\r\n","import { system,Player,Entity,EntityComponentTypes,ItemComponentTypes,EntityEquippableComponent,EquipmentSlot,\r\n    ItemDurabilityComponent,EntityApplyDamageOptions\r\n } from \"@minecraft/server\";\r\nimport { print, playsound, durabilityDamage, breakItem } from \"./common/commonUtil\"\r\n\r\n// シールドガード\r\n/**\r\n * @param {Player} player\r\n * @param {Boolean} range\r\n */\r\nfunction shieldGuard(player:Player, range:Boolean) {\r\n    let equ = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n    let offhand = equ.getEquipment(EquipmentSlot.Offhand);\r\n    let mainhand = equ.getEquipment(EquipmentSlot.Mainhand);\r\n    if (player.isSneaking) {\r\n        // シールド耐久\r\n        if (offhand != undefined && (offhand.typeId.indexOf(\"_shield\") != -1)) {\r\n            let dur = offhand.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n            if (dur.maxDurability > (dur.damage + 1)) {\r\n                durabilityDamage(player, offhand, \"slot.weapon.offhand\", EquipmentSlot.Offhand, 1);\r\n                playsound(player, \"item.shield.block\");\r\n            } else {\r\n                breakItem(player, \"slot.weapon.offhand\");\r\n            }\r\n        } else if (mainhand != undefined && (mainhand.typeId.indexOf(\"_shield\") != -1)) {\r\n            let dur = mainhand.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n            if (dur.maxDurability > (dur.damage + 1)) {\r\n                durabilityDamage(player, mainhand, \"slot.weapon.mainhand\", EquipmentSlot.Mainhand, 1);\r\n                playsound(player, \"item.shield.block\");\r\n            } else {\r\n                breakItem(player, \"slot.weapon.mainhand\");\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\n// シールドカウンター\r\n/**\r\n * @param {Player} player\r\n * @param {Entity} damager\r\n */\r\nfunction shieldCounter(player:Player, damager:Entity) {\r\n    let equ = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n    let offhand = equ.getEquipment(EquipmentSlot.Offhand);\r\n    let mainhand = equ.getEquipment(EquipmentSlot.Mainhand);\r\n    if (player.isSneaking) {\r\n        // 火の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:fire_magic_shield\") {\r\n            damager.applyDamage(3,{\"cause\":\"lava\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:mobflame_firing ~~~\");\r\n            let intervalNum = system.runInterval(() => {\r\n                if (damager) {\r\n                    let health = damager.getComponent(EntityComponentTypes.Health);\r\n                    if (health) {\r\n                        damager.applyDamage(3,{\"cause\":\"lava\"} as EntityApplyDamageOptions);\r\n                        damager.runCommand(\"particle kurokumaft:mobflame_firing ~~~\");\r\n                    }\r\n                }\r\n            }, 5);\r\n            system.runTimeout(() => {\r\n                system.clearRun(intervalNum);\r\n            }, 15);\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:fire_magic_shield\") {\r\n            damager.applyDamage(3,{\"cause\":\"lava\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:mobflame_firing ~~~\");\r\n            let intervalNum = system.runInterval(() => {\r\n                if (damager) {\r\n                    let health = damager.getComponent(EntityComponentTypes.Health);\r\n                    if (health) {\r\n                        damager.applyDamage(3,{\"cause\":\"lava\"} as EntityApplyDamageOptions);\r\n                        damager.runCommand(\"particle kurokumaft:mobflame_firing ~~~\");\r\n                    }\r\n                }\r\n            }, 5);\r\n            system.runTimeout(() => {\r\n                system.clearRun(intervalNum);\r\n            }, 15);\r\n        }\r\n        // 水の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:water_magic_shield\") {\r\n            damager.applyDamage(1,{\"cause\":\"drowning\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:water_sword_particle ~~~\");\r\n            damager.addEffect(\"weakness\",600,{\"amplifier\":1,\"showParticles\":true});\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:water_magic_shield\") {\r\n            damager.applyDamage(1,{\"cause\":\"drowning\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:water_sword_particle ~~~\");\r\n            damager.addEffect(\"weakness\",600,{\"amplifier\":1,\"showParticles\":true});\r\n        }\r\n        // 風の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:wind_magic_shield\") {\r\n            let view = player.getViewDirection();\r\n            damager.applyDamage(1,{\"cause\":\"fall\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:aero_bomb_short_particle ~~~\");\r\n            damager.applyKnockback(Math.round(view.x)*10,Math.round(view.z)*10,10,1);\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:wind_magic_shield\") {\r\n            let view = player.getViewDirection();\r\n            damager.applyDamage(1,{\"cause\":\"fall\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:aero_bomb_short_particle ~~~\");\r\n            damager.applyKnockback(Math.round(view.x)*10,Math.round(view.z)*10,10,1);\r\n        }\r\n        // 雷の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:thunder_magic_shield\") {\r\n            damager.applyDamage(3,{\"cause\":\"lightning\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle minecraft:snowflake_particle ~~~\");\r\n            let intervalNum = system.runInterval(() => {\r\n                if (damager) {\r\n                    let health = damager.getComponent(EntityComponentTypes.Health);\r\n                    if (health) {\r\n                        damager.applyDamage(3,{\"cause\":\"lightning\"} as EntityApplyDamageOptions);\r\n                        damager.runCommand(\"particle minecraft:snowflake_particle ~~~\");\r\n                    }\r\n                }\r\n            }, 5);\r\n            system.runTimeout(() => {\r\n                system.clearRun(intervalNum);\r\n            }, 15);\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:thunder_magic_shield\") {\r\n            damager.applyDamage(3,{\"cause\":\"lightning\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:thunder_sword_particle ~~~\");\r\n            let intervalNum = system.runInterval(() => {\r\n                if (damager) {\r\n                    let health = damager.getComponent(EntityComponentTypes.Health);\r\n                    if (health) {\r\n                        damager.applyDamage(3,{\"cause\":\"lightning\"} as EntityApplyDamageOptions);\r\n                        damager.runCommand(\"particle kurokumaft:thunder_sword_particle ~~~\");\r\n                    }\r\n                }\r\n            }, 5);\r\n            system.runTimeout(() => {\r\n                system.clearRun(intervalNum);\r\n            }, 15);\r\n        }\r\n        // 岩の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:stone_magic_shield\") {\r\n            let view = player.getViewDirection();\r\n            damager.applyDamage(1,{\"cause\":\"piston\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:grey_bomb_short_particle ~~~\");\r\n            damager.applyKnockback(Math.round(view.x)*10,Math.round(view.z)*10,10,1);\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:stone_magic_shield\") {\r\n            let view = player.getViewDirection();\r\n            damager.applyDamage(1,{\"cause\":\"piston\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:grey_bomb_short_particle ~~~\");\r\n            damager.applyKnockback(Math.round(view.x)*10,Math.round(view.z)*10,10,1);\r\n        }\r\n        // 氷の盾\r\n        if (offhand != undefined && offhand.typeId == \"kurokumaft:ice_magic_shield\") {\r\n            damager.applyDamage(1,{\"cause\":\"freezing\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:ice_sword_particle ~~~\");\r\n            damager.addEffect(\"slowness\",200,{\"amplifier\":1,\"showParticles\":false});\r\n        } else if (mainhand != undefined && mainhand.typeId == \"kurokumaft:ice_magic_shield\") {\r\n            damager.applyDamage(1,{\"cause\":\"freezing\"} as EntityApplyDamageOptions);\r\n            damager.runCommand(\"particle kurokumaft:ice_sword_particle ~~~\");\r\n            damager.addEffect(\"slowness\",200,{\"amplifier\":1,\"showParticles\":false});\r\n        }\r\n    }\r\n};\r\n\r\nexport { shieldGuard, shieldCounter };\r\n","import { world,system,Player,Entity,ItemStack,EntityComponentTypes,ItemComponentTypes,EntityEquippableComponent,EquipmentSlot,ItemEnchantableComponent,ItemDurabilityComponent} from \"@minecraft/server\";\r\n\r\nconst CraftBlocks = [\"minecraft:crafting_table\",\"minecraft:anvil\",\"minecraft:smithing_table\",\"minecraft:cartography_table\",\"minecraft:loom\",\"minecraft:barrel\"\r\n                    ,\"minecraft:smoker\",\"minecraft:blast_furnace\",\"minecraft:furnace\",\"kurokumaft:magic_lectern\"];\r\n\r\n// デバッグ用\r\n/**\r\n * @param {String} text\r\n */\r\nfunction print(text:String) {\r\n    world.sendMessage(text + \"\");\r\n};\r\n\r\n// 乱数\r\n/**\r\n * @param {number} min\r\n * @param {number} max\r\n */\r\nfunction getRandomInRange(min:number, max:number) {\r\n    return Math.random() * (max - min) + min;\r\n}\r\n\r\n// サウンド再生\r\n/**\r\n * @param {Entity} entity\r\n * @param {String} sound\r\n */\r\nfunction playsound(entity:Entity, sound:String) {\r\n    let commandText =  \"playsound \" + sound + \" @s\";\r\n    entity.runCommandAsync(commandText);\r\n};\r\n\r\n// 耐久値減少\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n * @param {String} slotName\r\n * @param {EquipmentSlot} slot\r\n * @param {number} damage\r\n */\r\nfunction durabilityDamage(player:Player, item:ItemStack, slotName:String, slot:EquipmentSlot, damage:number) {\r\n    let dur = item.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n    let enc = item.getComponent(ItemComponentTypes.Enchantable) as ItemEnchantableComponent;\r\n    let encs = null;\r\n    if (enc) {\r\n        encs = enc.getEnchantments();\r\n    }\r\n    let commandText =  \"replaceitem entity @s \" + slotName + \" 0 \" + item.typeId + \" 1 \" + (dur.damage + damage);\r\n    player.runCommand(commandText);\r\n\r\n    if (encs) {\r\n        let intervalNum = system.runInterval(() => {\r\n            let reEqu = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n            let reItem = reEqu.getEquipment(slot) as ItemStack ;\r\n            let reEnc = reItem.getComponent(ItemComponentTypes.Enchantable) as ItemEnchantableComponent;\r\n            for (let i=0;i<encs.length;i++) {\r\n                reEnc.addEnchantment(encs[i]);\r\n            }\r\n        \r\n            reEqu.setEquipment(slot, reItem);\r\n        \r\n        }, 2);\r\n        system.runTimeout(() => {\r\n            system.clearRun(intervalNum);\r\n        }, 3);\r\n    }\r\n};\r\n\r\n// アイテム破壊\r\n/**\r\n * @param {Player} player\r\n * @param {String} slotName\r\n */\r\nfunction breakItem(player:Player, slotName:String) {\r\n    let commandText =  \"replaceitem entity @s \" + slotName + \" 0 destroy air\";\r\n    player.runCommand(commandText);\r\n};\r\n\r\n// ミュージックレコード\r\nconst MusicRecodes = Object.freeze([\r\n    \"record.5\",\r\n    \"record.relic\",\r\n    \"record.13\",\r\n    \"record.cat\",\r\n    \"record.blocks\",\r\n    \"record.chirp\",\r\n    \"record.far\",\r\n    \"record.mall\",\r\n    \"record.mellohi\",\r\n    \"record.stal\",\r\n    \"record.strad\",\r\n    \"record.ward\",\r\n    \"record.11\",\r\n    \"record.wait\",\r\n    \"record.pigstep\",\r\n    \"record.otherside\"\r\n]);\r\n\r\nexport { print, getRandomInRange, playsound, durabilityDamage, breakItem, CraftBlocks, MusicRecodes };\r\n","import { world,system,Player,Block,Entity,EntityComponentTypes,ItemStack,Direction,ItemComponentTypes,Dimension\r\n    ,EntityInventoryComponent,\r\n    ItemCooldownComponent,\r\n    ItemDurabilityComponent,\r\n    Container\r\n } from \"@minecraft/server\";\r\nimport { print, CraftBlocks, MusicRecodes } from \"./common/commonUtil\";\r\nimport MagicBookComponent from \"./magic/MagicBookComponent\";\r\nimport { ModalFormData } from \"@minecraft/server-ui\";\r\n\r\n// 帰還の実で転移\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nfunction home_tp(player:Player, item:ItemStack) {\r\n    let lores = item.getLore();\r\n    if (lores.length > 0 && lores[0].indexOf(\"拠点\") != -1) {\r\n        let entity = world.getEntity(lores[4].substr(3));\r\n        // if (entity != undefined && entity.typeId == \"kurokumaft:home_gate\") {\r\n            let text = \"tp @s \" + lores[1].substr(2) + \" \" + lores[2].substr(2) + \" \" + lores[3].substr(2);\r\n            player.runCommand(text);\r\n        // } else {\r\n        //     print(\"登録した拠点は使用出来ません。\");\r\n        // }\r\n    }\r\n};\r\n\r\n// ホームゲートに転移場所設定\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n * @param {Entity} target\r\n */\r\nfunction homeSetDialog(player:Player, item:ItemStack, target:Entity) {\r\n\r\n    let modalForm = new ModalFormData().title(\"拠点名を入力\");\r\n    modalForm.textField('拠点名', '');\r\n    modalForm\r\n        .show(player)\r\n        .then(formData => {\r\n            // player.sendMessage(`Modal form results: ${JSON.stringify(formData.formValues, undefined, 2)}`);\r\n            if (!formData.formValues) {\r\n                return;\r\n            }\r\n            item.setLore([\"拠点:\" + formData.formValues[0],\"x:\"+target.location.x,\"y:\"+target.location.y,\"x:\"+target.location.z,\"id:\"+target.id]);\r\n            let inventory = player.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n            if (inventory && inventory.container) {\r\n                inventory.container.setItem(player.selectedSlotIndex, item);\r\n                target.addTag(\"home_gate_set\");\r\n                player.sendMessage(`拠点を登録しました。`)\r\n            }\r\n        })\r\n        .catch((error) => {\r\n            return -1;\r\n        });\r\n};\r\n\r\n// 魔導書（トーチ）使用\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {ItemStack} item\r\n */\r\nfunction torchlight_use(player:Player, block:Block, item:ItemStack) {\r\n    // print(block.typeId);\r\n    if ((block.typeId.indexOf(\"chest\") == -1) && (block.typeId.indexOf(\"boat\") == -1) && (CraftBlocks.indexOf(block.typeId) == -1)) {\r\n        decrimentGrimoireCount(player, item);\r\n \r\n    }\r\n};\r\n\r\nconst BlockLocationList = Object.freeze([\r\n    {\r\n        direction: Direction.Up,\r\n        location: {x:0,y:1,z:0}\r\n    },\r\n    {\r\n        direction: Direction.Down,\r\n        location: {x:0,y:-1,z:0}\r\n    },\r\n    {\r\n        direction: Direction.South,\r\n        location: {x:0,y:0,z:1}\r\n    },\r\n    {\r\n        direction: Direction.North,\r\n        location: {x:0,y:0,z:-1}\r\n    },\r\n    {\r\n        direction: Direction.East,\r\n        location: {x:1,y:0,z:0}\r\n    },\r\n    {\r\n        direction: Direction.West,\r\n        location: {x:-1,y:0,z:0}\r\n    }\r\n\r\n]);\r\n\r\n// 魔導書（イグナイテッド）使用\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {Direction} direction\r\n * @param {ItemStack} item\r\n */\r\nfunction ignited_use_af(player:Player, block:Block, direction:Direction, item:ItemStack) {\r\n\r\n    // print(item.typeId);\r\n    // print(block.typeId);\r\n    let blockPer = block.permutation;\r\n    let extinguished = blockPer.getState(\"extinguished\");\r\n    let lit = blockPer.getState(\"lit\");\r\n    let blockDim = block.dimension as Dimension;\r\n    let bx = block.location.x;\r\n    let by = block.location.y;\r\n    let bz = block.location.z;\r\n\r\n    let setFireF = false;\r\n    let setLocation = \"\";\r\n\r\n    if ((CraftBlocks.indexOf(block.typeId) != -1)) {\r\n        return;\r\n    }\r\n    if (extinguished) {\r\n        block.setPermutation(blockPer.withState(\"extinguished\", false));\r\n        setFireF = true;\r\n    } else if (lit != undefined && !lit) {\r\n        block.setPermutation(blockPer.withState(\"lit\", true));\r\n        setFireF = true;\r\n    } else {\r\n        BlockLocationList.forEach(obj => {\r\n            if (obj.direction == direction) {\r\n                let vec = {\"x\":bx+obj.location.x,\"y\":by+obj.location.y,\"z\":bz+obj.location.z};\r\n                // print(blockDim.getBlock(vec));\r\n                let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                if(dimeBlock.isAir) {\r\n                    setLocation = (bx+obj.location.x) + \" \" + (by+obj.location.y) + \" \" + (bz+obj.location.z);\r\n                    player.runCommand(\"setblock \" + setLocation + \" minecraft:fire [\\\"age\\\"=0]\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    if (setFireF) {\r\n        decrimentGrimoireCount(player, item);\r\n    }\r\n\r\n};\r\n\r\n// 魔導書（イグナイテッド）使用(tnt着火用)\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {Direction} direction\r\n * @param {ItemStack} item\r\n */\r\nfunction ignited_use_be(player:Player, block:Block, direction:Direction, item:ItemStack) {\r\n\r\n    // print(item.typeId);\r\n    // print(block.typeId);\r\n    let bx = block.location.x;\r\n    let by = block.location.y;\r\n    let bz = block.location.z;\r\n\r\n    if ((CraftBlocks.indexOf(block.typeId) != -1)) {\r\n        return;\r\n    }\r\n\r\n    if (block.typeId == \"minecraft:tnt\") {\r\n        // print(\"tnt spawn\");\r\n        player.runCommand(\"setblock \" + bx + \" \" + by + \" \" + bz + \" minecraft:air\");\r\n        player.runCommand(\"summon minecraft:tnt \" + bx + \" \" + by + \" \" + bz + \" ~ ~ from_explosion\");\r\n\r\n        decrimentGrimoireCount(player, item);\r\n    \r\n    }\r\n\r\n};\r\n\r\n// 魔導書（ウォーター）使用\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {Direction} direction\r\n * @param {ItemStack} item\r\n */\r\nfunction water_use(player:Player, block:Block, direction:Direction, item:ItemStack) {\r\n\r\n    // print(item.typeId);\r\n    // print(block.typeId);\r\n    let blockPer = block.permutation;\r\n    let cauldron = blockPer.getState(\"cauldron_liquid\");\r\n    let blockDim = block.dimension;\r\n    let bx = block.location.x;\r\n    let by = block.location.y;\r\n    let bz = block.location.z;\r\n\r\n    let setFireF = false;\r\n    let setLocation = \"\";\r\n\r\n    if ((CraftBlocks.indexOf(block.typeId) != -1)) {\r\n        return;\r\n    }\r\n    if (cauldron) {\r\n        block.setPermutation(blockPer.withState(\"cauldron_liquid\", \"water\"));\r\n        block.setPermutation(blockPer.withState(\"fill_level\", 6));\r\n        setFireF = true;\r\n    } else {\r\n        BlockLocationList.forEach(obj => {\r\n            if (obj.direction == direction) {\r\n                let vec = {\"x\":bx+obj.location.x,\"y\":by+obj.location.y,\"z\":bz+obj.location.z};\r\n                // print(blockDim.getBlock(vec));\r\n                let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                if(dimeBlock.isAir) {\r\n                    setLocation = (bx+obj.location.x) + \" \" + (by+obj.location.y) + \" \" + (bz+obj.location.z);\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    if (setFireF) {\r\n        player.runCommand(\"setblock \" + setLocation + \" minecraft:flowing_water [\\\"liquid_depth\\\"=0]\");\r\n        decrimentGrimoireCount(player, item);\r\n    }\r\n\r\n};\r\n\r\nconst FlowerBlockS = Object.freeze([\r\n    \"\",\r\n    \"\",\r\n    \"\",\r\n    \"\",\r\n    \"\",\r\n    \"\",\r\n    \"\",\r\n    \"minecraft:tallgrass\",\r\n    \"minecraft:poppy\",\r\n    \"minecraft:blue_orchid\",\r\n    \"minecraft:allium\",\r\n    \"minecraft:azure_bluet\",\r\n    \"minecraft:red_tulip\",\r\n    \"minecraft:orange_tulip\",\r\n    \"minecraft:white_tulip\",\r\n    \"minecraft:pink_tulip\",\r\n    \"minecraft:oxeye_daisy\",\r\n    \"minecraft:cornflower\",\r\n    \"minecraft:lily_of_the_valley\",\r\n    \"minecraft:yellow_flower\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"sunflower\\\", \\\"upper_block_bit\\\"=false]\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"syringa\\\", \\\"upper_block_bit\\\"=false]\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"grass\\\", \\\"upper_block_bit\\\"=false]\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"fern\\\", \\\"upper_block_bit\\\"=false]\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"rose\\\", \\\"upper_block_bit\\\"=false]\",\r\n    \"minecraft:double_plant [\\\"double_plant_type\\\"=\\\"paeonia\\\", \\\"upper_block_bit\\\"=false]\"\r\n]);\r\n\r\n// 魔導書（フラワーガーデン）使用\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {Direction} direction\r\n * @param {ItemStack} item\r\n */\r\nfunction flower_garden_use(player:Player, block:Block, direction:Direction, item:ItemStack) {\r\n\r\n    // print(item.typeId);\r\n    // print(block.typeId);\r\n    let blockPer = block.permutation;\r\n    let blockDim = block.dimension;\r\n    let bx = block.location.x;\r\n    let by = block.location.y;\r\n    let bz = block.location.z;\r\n\r\n    let itemCool = item.getComponent(ItemComponentTypes.Cooldown) as ItemCooldownComponent;\r\n\r\n    let setFireF = false;\r\n\r\n    if (itemCool.getCooldownTicksRemaining(player) != 0) {\r\n        return;\r\n    }\r\n    if ((CraftBlocks.indexOf(block.typeId) != -1)) {\r\n        return;\r\n    }\r\n    if (block.typeId == \"minecraft:grass_block\") {\r\n        if (direction == Direction.Up) {\r\n            player.runCommand(\"particle kurokumaft:flower_garden_growth_emitter ~~~\");\r\n            itemCool.startCooldown(player);\r\n            let xpcount1 = 0;\r\n            let intervalNumXP = system.runInterval(() => {\r\n                for (let z=0; z<8;z++) {\r\n                    let vec = {\"x\":bx+xpcount1,\"y\":by,\"z\":bz+z};\r\n                    let upvec = {\"x\":bx+xpcount1,\"y\":by+1,\"z\":bz+z};\r\n                    let dupvec = {\"x\":bx+xpcount1,\"y\":by+2,\"z\":bz+z};\r\n\r\n                    let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                    let updimeBlock = blockDim.getBlock(upvec) as Block;\r\n                    if(dimeBlock.typeId == \"minecraft:grass_block\" && updimeBlock.isAir) {\r\n                        let randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        if (randomBlock == \"\") {\r\n                            continue;\r\n                        }\r\n                        let dupdimeBlock = blockDim.getBlock(dupvec) as Block;\r\n                        while (randomBlock.indexOf(\"double\") != -1 && !dupdimeBlock.isAir) {\r\n                            randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        }\r\n                        player.runCommand(\"setblock \" + (bx+xpcount1) + \" \" + (by+1) + \" \" + (bz+z) + \" \" + randomBlock);\r\n                        setFireF = true;\r\n                    }\r\n                }\r\n\r\n                xpcount1++;\r\n\r\n            }, 1);\r\n\r\n            let xmcount1 = 0;\r\n            let intervalNumXM = system.runInterval(() => {\r\n                for (let z=0; z<8;z++) {\r\n                    let vec = {\"x\":bx+xmcount1,\"y\":by,\"z\":bz+z};\r\n                    let upvec = {\"x\":bx+xmcount1,\"y\":by+1,\"z\":bz+z};\r\n                    let dupvec = {\"x\":bx+xmcount1,\"y\":by+2,\"z\":bz+z};\r\n\r\n                    let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                    let updimeBlock = blockDim.getBlock(upvec) as Block;\r\n                    if(dimeBlock.typeId == \"minecraft:grass_block\" && updimeBlock.isAir) {\r\n                        let randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        if (randomBlock == \"\") {\r\n                            continue;\r\n                        }\r\n                        let dupdimeBlock = blockDim.getBlock(dupvec) as Block;\r\n                        while (randomBlock.indexOf(\"double\") != -1 && !dupdimeBlock.isAir) {\r\n                            randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        }\r\n                        player.runCommand(\"setblock \" + (bx+xmcount1) + \" \" + (by+1) + \" \" + (bz+z) + \" \" + randomBlock);\r\n                        setFireF = true;\r\n                    }\r\n                }\r\n                xmcount1--;\r\n\r\n            }, 1);\r\n\r\n            let xpcount2 = 0;\r\n            let intervalNumZP = system.runInterval(() => {\r\n                for (let z=-1; z>-8;z--) {\r\n                    let vec = {\"x\":bx+xpcount2,\"y\":by,\"z\":bz+z};\r\n                    let upvec = {\"x\":bx+xpcount2,\"y\":by+1,\"z\":bz+z};\r\n                    let dupvec = {\"x\":bx+xpcount2,\"y\":by+2,\"z\":bz+z};\r\n\r\n                    let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                    let updimeBlock = blockDim.getBlock(upvec) as Block;\r\n                    if(dimeBlock.typeId == \"minecraft:grass_block\" && updimeBlock.isAir) {\r\n                        let randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        if (randomBlock == \"\") {\r\n                            continue;\r\n                        }\r\n                        let dupdimeBlock = blockDim.getBlock(dupvec) as Block;\r\n                        while (randomBlock.indexOf(\"double\") != -1 && !dupdimeBlock.isAir) {\r\n                            randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        }\r\n                        player.runCommand(\"setblock \" + (bx+xpcount2) + \" \" + (by+1) + \" \" + (bz+z) + \" \" + randomBlock);\r\n                        setFireF = true;\r\n                    }\r\n                }\r\n\r\n                xpcount2++;\r\n\r\n            }, 1);\r\n\r\n            let xmcount2 = 0;\r\n            let intervalNumZM = system.runInterval(() => {\r\n                for (let z=-1; z>-8;z--) {\r\n                    let vec = {\"x\":bx+xmcount2,\"y\":by,\"z\":bz+z};\r\n                    let upvec = {\"x\":bx+xmcount2,\"y\":by+1,\"z\":bz+z};\r\n                    let dupvec = {\"x\":bx+xmcount2,\"y\":by+2,\"z\":bz+z};\r\n\r\n                    let dimeBlock = blockDim.getBlock(vec) as Block;\r\n                    let updimeBlock = blockDim.getBlock(upvec) as Block;\r\n                    if(dimeBlock.typeId == \"minecraft:grass_block\" && updimeBlock.isAir) {\r\n                        let randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        if (randomBlock == \"\") {\r\n                            continue;\r\n                        }\r\n                        let dupdimeBlock = blockDim.getBlock(dupvec) as Block;\r\n                        while (randomBlock.indexOf(\"double\") != -1 && !dupdimeBlock.isAir) {\r\n                            randomBlock = FlowerBlockS[Math.floor(Math.random() * FlowerBlockS.length)];\r\n                        }\r\n                        player.runCommand(\"setblock \" + (bx+xmcount2) + \" \" + (by+1) + \" \" + (bz+z) + \" \" + randomBlock);\r\n                        setFireF = true;\r\n                    }\r\n                }\r\n\r\n                xmcount2--;\r\n\r\n            }, 1);\r\n\r\n            system.runTimeout(() => {\r\n                system.clearRun(intervalNumXP);\r\n                system.clearRun(intervalNumZP);\r\n                system.clearRun(intervalNumXM);\r\n                system.clearRun(intervalNumZM);\r\n\r\n                if (setFireF) {\r\n                    decrimentGrimoireCount(player, item);\r\n                }\r\n            }, 15);\r\n        }\r\n    }\r\n\r\n};\r\n\r\nconst wood_sapling = Object.freeze([\r\n    \"minecraft:oak_sapling\",\r\n    \"minecraft:spruce_sapling\",\r\n    \"minecraft:birch_sapling\",\r\n    \"minecraft:jungle_sapling\",\r\n    \"minecraft:acacia_sapling\",\r\n    \"minecraft:dark_oak_sapling\"\r\n]);\r\n\r\n// 魔導書（グロウス）使用\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n * @param {Direction} direction\r\n * @param {ItemStack} item\r\n */\r\nfunction growth_use(player:Player, block:Block, direction:Direction, item:ItemStack) {\r\n\r\n    let blockPer = block.permutation;\r\n    let blockDim = block.dimension;\r\n    let bx = block.location.x;\r\n    let by = block.location.y;\r\n    let bz = block.location.z;\r\n\r\n    let setFireF = false;\r\n    let setLocation = \"\";\r\n\r\n    if ((CraftBlocks.indexOf(block.typeId) != -1)) {\r\n        return;\r\n    } else if (block.typeId == \"minecraft:bamboo\" || block.typeId == \"minecraft:bamboo_sapling\") {\r\n        if (block.typeId == \"minecraft:bamboo_sapling\") {\r\n            player.runCommand(\"setblock \" + (bx) + \" \" + (by) + \" \" + (bz) + \" minecraft:bamboo\");\r\n        }\r\n        let count = 1;\r\n        let demBlock = blockDim.getBlock({\"x\":bx,\"y\":by+count,\"z\":bz}) as Block;\r\n        while (count <= 15 && (demBlock.typeId == \"minecraft:bamboo\" || demBlock.isAir)) {\r\n            let blockCom = \"minecraft:bamboo [\\\"bamboo_leaf_size\\\"=\\\"no_leaves\\\", \\\"bamboo_stalk_thickness\\\" = \\\"thick\\\"]\";\r\n            if (count > 10) {\r\n                blockCom = \"minecraft:bamboo [\\\"bamboo_leaf_size\\\"=\\\"large_leaves\\\", \\\"bamboo_stalk_thickness\\\" = \\\"thick\\\"]\";\r\n            } else if (count > 5) {\r\n                blockCom = \"minecraft:bamboo [\\\"bamboo_leaf_size\\\"=\\\"small_leaves\\\", \\\"bamboo_stalk_thickness\\\" = \\\"thick\\\"]\";\r\n            }\r\n            player.runCommand(\"setblock \" + (bx) + \" \" + (by+count) + \" \" + (bz) + \" \" + blockCom);\r\n            count++;\r\n        }\r\n        player.runCommand(\"particle minecraft:crop_growth_emitter \" + (bx) + \" \" + (by) + \" \" + (bz));\r\n    } else if (block.typeId == \"minecraft:twisting_vines\") {\r\n        let vin_count = 1;\r\n        let vinBlock = blockDim.getBlock({\"x\":bx,\"y\":by+vin_count,\"z\":bz}) as Block;\r\n        while ((vinBlock.typeId == \"minecraft:twisting_vines\")) {\r\n            vin_count++;\r\n        }\r\n        let air_count = vin_count + 1;\r\n        let air_last = (air_count+15);\r\n        let airBlock = blockDim.getBlock({\"x\":bx,\"y\":by+air_count,\"z\":bz}) as Block;\r\n        while (air_count <= air_last && airBlock.isAir) {\r\n            air_count++;\r\n        }\r\n        player.runCommand(\"fill \" + (bx) + \" \" + (by+vin_count) + \" \" + (bz) + \" \" + (bx) + \" \" + (by+air_count) + \" \" + (bz) + \" minecraft:twisting_vines\");\r\n        player.runCommand(\"particle minecraft:crop_growth_emitter \" + (bx) + \" \" + (by) + \" \" + (bz));\r\n    } else if (block.typeId == \"minecraft:cave_vines\") {\r\n        let up_count = 1;\r\n        let upBlock = blockDim.getBlock({\"x\":bx,\"y\":by+up_count,\"z\":bz}) as Block;\r\n        while ((upBlock.typeId == \"minecraft:cave_vines\")) {\r\n            up_count++;\r\n        }\r\n        let down_count = 0;\r\n        let downBlock = blockDim.getBlock({\"x\":bx,\"y\":by+down_count,\"z\":bz}) as Block;\r\n        while ((downBlock.typeId == \"minecraft:cave_vines\")) {\r\n            down_count--;\r\n        }\r\n        player.runCommand(\"fill \" + (bx) + \" \" + (by+down_count+2) + \" \" + (bz) + \" \" + (bx) + \" \" + (by+up_count-1) + \" \" + (bz) + \" minecraft:cave_vines_body_with_berries\");\r\n        player.runCommand(\"setblock \" + (bx) + \" \" + (by+down_count+1) + \" \" + (bz) + \" minecraft:cave_vines_head_with_berries\");\r\n        player.runCommand(\"particle minecraft:crop_growth_emitter \" + (bx) + \" \" + (by) + \" \" + (bz));\r\n\r\n    } else if (block.typeId == \"minecraft:reeds\") {\r\n        let vin_count = 1;\r\n        let vinBlock = blockDim.getBlock({\"x\":bx,\"y\":by+vin_count,\"z\":bz}) as Block;\r\n        while ((vinBlock.typeId == \"minecraft:reeds\")) {\r\n            vin_count++;\r\n        }\r\n        let air_count = vin_count + 1;\r\n        let air_last = (air_count+15);\r\n        let airBlock = blockDim.getBlock({\"x\":bx,\"y\":by+air_count,\"z\":bz}) as Block;\r\n        while (air_count <= air_last && airBlock.isAir) {\r\n            air_count++;\r\n        }\r\n        player.runCommand(\"fill \" + (bx) + \" \" + (by+vin_count) + \" \" + (bz) + \" \" + (bx) + \" \" + (by+air_count) + \" \" + (bz) + \" minecraft:reeds\");\r\n        player.runCommand(\"particle minecraft:crop_growth_emitter \" + (bx) + \" \" + (by) + \" \" + (bz));\r\n    } else if ((wood_sapling.indexOf(block.typeId) != -1)) {\r\n        let age_bit = blockPer.getState(\"age_bit\");\r\n        if (age_bit) {\r\n\r\n        }\r\n    }\r\n\r\n    if (setFireF) {\r\n        decrimentGrimoireCount(player, item);\r\n    }\r\n\r\n};\r\n\r\nconst MowingBlocks = Object.freeze([\r\n    \"minecraft:bamboo\",\r\n    \"minecraft:bamboo_sapling\",\r\n    \"minecraft:acacia_leaves\",\r\n    \"minecraft:dark_oak_leaves\",\r\n    \"minecraft:oak_leaves\",\r\n    \"minecraft:spruce_leaves\",\r\n    \"minecraft:birch_leaves\",\r\n    \"minecraft:jungle_leaves\",\r\n    \"minecraft:azalea_leaves\",\r\n    \"minecraft:azalea_leaves_flowered\",\r\n    \"minecraft:cherry_leaves\",\r\n    \"minecraft:mangrove_leaves\",\r\n    \"minecraft:reeds\",\r\n    \"minecraft:cave_vines\",\r\n    \"minecraft:cave_vines_body_with_berries\",\r\n    \"minecraft:cave_vines_head_with_berries\",\r\n    \"minecraft:twisting_vines\",\r\n    \"minecraft:wheat\",\r\n    \"minecraft:vine\",\r\n    \"minecraft:pumpkin_stem\",\r\n    \"minecraft:pumpkin\",\r\n    \"minecraft:warped_stem\",\r\n    \"minecraft:crimson_stem\",\r\n    \"minecraft:melon_stem\",\r\n    \"minecraft:melon\",\r\n    \"minecraft:cocoa\",\r\n    \"minecraft:potatoes\",\r\n    \"minecraft:carrots\",\r\n    \"minecraft:sweet_berry_bush\",\r\n    \"minecraft:kelp\",\r\n    \"minecraft:brown_mushroom\",\r\n    \"minecraft:brown_mushroom_block\",\r\n    \"minecraft:red_mushroom\",\r\n    \"minecraft:red_mushroom_block\",\r\n    \"minecraft:crimson_fungus\",\r\n    \"minecraft:warped_fungus\",\r\n    \"minecraft:tallgrass\",\r\n    \"minecraft:poppy\",\r\n    \"minecraft:blue_orchid\",\r\n    \"minecraft:allium\",\r\n    \"minecraft:azure_bluet\",\r\n    \"minecraft:red_tulip\",\r\n    \"minecraft:orange_tulip\",\r\n    \"minecraft:white_tulip\",\r\n    \"minecraft:pink_tulip\",\r\n    \"minecraft:oxeye_daisy\",\r\n    \"minecraft:cornflower\",\r\n    \"minecraft:lily_of_the_valley\",\r\n    \"minecraft:yellow_flower\",\r\n    \"minecraft:lilac\",\r\n    \"minecraft:large_fern\",\r\n    \"minecraft:rose_bush\",\r\n    \"minecraft:tall_grass\",\r\n    \"minecraft:short_grass\",\r\n    \"minecraft:sunflower\",\r\n    \"minecraft:peony\",\r\n    \"minecraft:double_plant\"\r\n]);\r\n\r\n// 魔導書（モーヴィング）使用\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nfunction mowing_use(player:Player, item:ItemStack) {\r\n\r\n    let playerDim = player.dimension;\r\n    let bx = player.location.x;\r\n    let by = player.location.y;\r\n    let bz = player.location.z;\r\n\r\n    let setFireF = false;\r\n    let xpcount1 = 0;\r\n    let intervalNumXP = system.runInterval(() => {\r\n        for (let z=0; z<10;z++) {\r\n            for (let y=0; y<10;y++) {\r\n                let vec = {\"x\":bx+xpcount1,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xpcount1) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n            for (let y=-1; y>-3;y--) {\r\n                let vec = {\"x\":bx+xpcount1,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xpcount1) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        }\r\n        xpcount1++;\r\n    }, 1);\r\n\r\n    let xmcount1 = 0;\r\n    let intervalNumXM = system.runInterval(() => {\r\n        for (let z=0; z<10;z++) {\r\n            for (let y=0; y<10;y++) {\r\n                let vec = {\"x\":bx+xmcount1,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xmcount1) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n            for (let y=-1; y>-3;y--) {\r\n                let vec = {\"x\":bx+xmcount1,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xmcount1) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        }\r\n        xmcount1--;\r\n    }, 1);\r\n\r\n    let xpcount2 = 0;\r\n    let intervalNumZP = system.runInterval(() => {\r\n        for (let z=-1; z>-10;z--) {\r\n            for (let y=0; y<10;y++) {\r\n                let vec = {\"x\":bx+xpcount2,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xpcount2) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n            for (let y=-1; y>-3;y--) {\r\n                let vec = {\"x\":bx+xpcount2,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xpcount2) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        }\r\n        xpcount2++;\r\n    }, 1);\r\n\r\n    let xmcount2 = 0;\r\n    let intervalNumZM = system.runInterval(() => {\r\n        for (let z=-1; z>-10;z--) {\r\n            for (let y=0; y<10;y++) {\r\n                let vec = {\"x\":bx+xmcount2,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xmcount2) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n            for (let y=-1; y>-3;y--) {\r\n                let vec = {\"x\":bx+xmcount2,\"y\":by+y,\"z\":bz+z};\r\n                let dimBlock = playerDim.getBlock(vec) as Block;\r\n                if(!dimBlock.isAir && MowingBlocks.indexOf(dimBlock.typeId) != -1) {\r\n                    player.runCommand(\"setblock \" + (bx+xmcount2) + \" \" + (by+y) + \" \" + (bz+z) + \" air destroy\");\r\n                    setFireF = true;\r\n                }\r\n            }\r\n        }\r\n        xmcount2--;\r\n    }, 1);\r\n\r\n    player.runCommand(\"particle kurokumaft:mowing_particle \" + (bx) + \" \" + (by) + \" \" + (bz));\r\n\r\n    system.runTimeout(() => {\r\n        system.clearRun(intervalNumXP);\r\n        system.clearRun(intervalNumZP);\r\n        system.clearRun(intervalNumXM);\r\n        system.clearRun(intervalNumZM);\r\n\r\n        if (setFireF) {\r\n            decrimentGrimoireCount(player, item);\r\n        }\r\n    }, 15);\r\n\r\n};\r\n\r\n// 魔導書（プレイングサウンド）使用\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nfunction music_sound_use(player:Player, item:ItemStack) {\r\n    player.runCommand(\"music play \" + MusicRecodes[Math.floor(Math.random() * MusicRecodes.length)] + \" 1 5\");\r\n    decrimentGrimoireCount(player, item);\r\n};\r\n\r\n// 魔導書オブジェクトを保持するリストを作成\r\nconst magicBookList:Array<MagicBookComponent> = [];\r\n\r\n// 魔導書（召喚）使用開始\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nfunction grimoire_summon_use(player:Player, item:ItemStack) {\r\n    let particle = \"\";\r\n    if (item.typeId == \"kurokumaft:fire_grimoire\") {\r\n        particle = \"kurokumaft:fire_bread_particle\";\r\n    }\r\n    player.runCommand(\"particle \" + particle + \" ~~0.75~\");\r\n    let intervalNum = system.runInterval(() => {\r\n        player.runCommand(\"particle \" + particle + \" ~~0.75~\");\r\n    }, 10);\r\n    let durability = item.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n    let magicBook = new MagicBookComponent(player.id, item, durability.damage, intervalNum);\r\n    magicBookList.push(magicBook);\r\n    system.runTimeout(() => {\r\n        system.clearRun(intervalNum);\r\n    }, 60);\r\n\r\n};\r\n\r\n// 魔導書（召喚）使用解放\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n * @param {number} duration\r\n */\r\nfunction grimoire_summon_Release(player:Player, item:ItemStack, duration:number) {\r\n    let magicBook = magicBookList.find(book => book.isPlayerId(player.id)) as MagicBookComponent;\r\n    if (duration <= 900) {\r\n        let inventory = player.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n        let grimoire_damage = new ItemStack(item.typeId, 1);\r\n        let grimoire_dur = grimoire_damage.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n        let item_dur = item.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n\r\n        grimoire_dur.damage = item_dur.damage + 1;\r\n        if (item_dur.maxDurability != grimoire_dur.damage) {\r\n            let con = inventory.container as Container;\r\n            con.setItem(player.selectedSlotIndex, grimoire_damage);\r\n        }\r\n    }\r\n\r\n    let delIndex = magicBookList.findIndex(book => book.isPlayerId(player.id));\r\n    if (delIndex != -1) {\r\n        magicBookList.splice(delIndex, 1);\r\n    }\r\n    system.clearRun(magicBook.getIntervalNum());\r\n\r\n};\r\n\r\n// 魔導書耐久減少\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nfunction decrimentGrimoireCount(player:Player, item:ItemStack) {\r\n    let lore = item.getLore();\r\n    if (lore.length > 0) {\r\n        let cont = Number(lore[0].substr(3));\r\n        cont--;\r\n        let inventory = player.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n        let con = inventory.container as Container;\r\n        if (cont == 0) {\r\n            let grimoire_damage = new ItemStack(\"kurokumaft:grimoire_damage\", 1);\r\n            con.setItem(player.selectedSlotIndex, grimoire_damage);\r\n        } else {\r\n            item.setLore([\"残数：\" + cont]);\r\n            con.setItem(player.selectedSlotIndex, item);\r\n        }\r\n    }\r\n}\r\n\r\nexport { home_tp, homeSetDialog, torchlight_use, ignited_use_af, ignited_use_be, water_use, flower_garden_use, growth_use, \r\n    mowing_use, music_sound_use, grimoire_summon_use, grimoire_summon_Release };\r\n","import { ItemStack } from \"@minecraft/server\";\r\n\r\nclass MagicBookComponent {\r\n\r\n    playerId:String;     // プレイヤーID\r\n    item:ItemStack;         // ブック名\r\n    durability:Number;   // 耐久値\r\n    intervalNum:number;  // jobId\r\n\r\n    constructor(playerId:String, item:ItemStack, durability:Number, intervalNum:number) {\r\n        this.playerId = playerId;\r\n        this.item = item;\r\n        this.durability = durability;\r\n        this.intervalNum = intervalNum;\r\n    }\r\n    \r\n    isPlayerId(id:String) {\r\n        return id == this.playerId;\r\n    }\r\n    getItem() {\r\n        return this.item;\r\n    }\r\n    getDurability() {\r\n        return this.durability;\r\n    }\r\n    getIntervalNum() {\r\n        return this.intervalNum;\r\n    }\r\n}\r\n\r\nexport default MagicBookComponent;\r\n","import { system,world,Player,Entity,EntityComponentTypes,EntityInventoryComponent,ItemStack,Block,Dimension,BlockPermutation, Container, EntityEquippableComponent, EquipmentSlot, EntityHealthComponent, EntityApplyDamageOptions } from \"@minecraft/server\";\r\nimport { print, playsound, durabilityDamage, breakItem } from \"./common/commonUtil\";\r\nimport { getGrimoireObjectId, isGrimoireItemsObject, isGrimoireAllItemsObject, getGrimoireItemsMultiValue, \r\n    getGrimoireAllItemsMultiValue, getGrimoireAllItemsId, isGrimoireAllItemsId, getGrimoireAllObjectsId, getGrimoireAllItemsEvent, \r\n    GrimoireBook} from \"./magic/GrimoireBookComponent\";\r\nimport { getMagicStoneOjectByName, isMagicStoneOject, MagicStoneOjects } from \"./magic/MagicStoneComponet\";\r\nimport { ActionFormData } from \"@minecraft/server-ui\";\r\n\r\n// 魔導書見台\r\n/**\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n * @param {Block} block\r\n */\r\nfunction magic_lectern(player:Player, item:ItemStack, block:Block) {\r\n    let blockPer = block.permutation;\r\n    // print(\"book_set:\" + blockPer.getState(\"kurokumaft:book_set\"));\r\n    // print(\"stone_set:\" + blockPer.getState(\"kurokumaft:stone_set\"));\r\n    if (item != undefined) {\r\n        // print(\"アイテムあり\");\r\n        // print(item.typeId);\r\n        if (isGrimoireAllItemsId(item.typeId)) {\r\n            // print(\"魔導書\");\r\n            if (block.matches(block.typeId,{\"kurokumaft:book_set\":0})) {\r\n                block.setPermutation(blockPer.withState(\"kurokumaft:book_set\", 1));\r\n                let grimoire_book_entity = block.dimension.spawnEntity(\"kurokumaft:grimoire_book_entity\", {x:block.location.x+0.5,y:block.location.y+1,z:block.location.z+0.5});\r\n                let bookObj = getGrimoireAllObjectsId(item.typeId) as GrimoireBook;\r\n                grimoire_book_entity.triggerEvent(bookObj.event);\r\n                let invent = grimoire_book_entity.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n                let container = invent.container as Container;\r\n                let grimoire_empty = item.clone();\r\n                grimoire_empty.amount = 1;\r\n                container.addItem(grimoire_empty);\r\n\r\n                let direction = blockPer.getState(\"minecraft:cardinal_direction\");\r\n                if (direction == \"north\") {\r\n                    grimoire_book_entity.triggerEvent(\"kurokumaft:north\");\r\n                } else if (direction == \"south\") {\r\n                    grimoire_book_entity.triggerEvent(\"kurokumaft:south\");\r\n                } else if (direction == \"east\") {\r\n                    grimoire_book_entity.triggerEvent(\"kurokumaft:east\");\r\n                } else {\r\n                    grimoire_book_entity.triggerEvent(\"kurokumaft:west\");\r\n                }\r\n   \r\n            }\r\n        } else if (isMagicStoneOject(item.typeId)) {\r\n            // print(\"魔法石\");\r\n            let magic_stone_entitys = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n            for (let i=0; i<magic_stone_entitys.length; i++) {\r\n                if (magic_stone_entitys[i].typeId == \"kurokumaft:magic_stone_entity\") {\r\n                    magic_stone_entitys[i].triggerEvent(\"on_breaking\");\r\n                }\r\n            }\r\n            let magic_stone_entity = block.dimension.spawnEntity(\"kurokumaft:magic_stone_entity\", {x:block.location.x+0.5,y:block.location.y+1,z:block.location.z+0.5});\r\n            let stoneComp = getMagicStoneOjectByName(item.typeId) as MagicStoneOjects;\r\n\r\n            block.setPermutation(blockPer.withState(\"kurokumaft:stone_set\", stoneComp.state));\r\n            // print(\"stoneState:\" + stoneComp.state);\r\n            // print(\"stoneEvent:\" + stoneComp.event);\r\n            magic_stone_entity.triggerEvent(stoneComp.event);\r\n\r\n            let direction = blockPer.getState(\"minecraft:cardinal_direction\");\r\n            if (direction == \"north\") {\r\n                magic_stone_entity.triggerEvent(\"kurokumaft:north\");\r\n            } else if (direction == \"south\") {\r\n                magic_stone_entity.triggerEvent(\"kurokumaft:south\");\r\n            } else if (direction == \"east\") {\r\n                magic_stone_entity.triggerEvent(\"kurokumaft:east\");\r\n            } else {\r\n                magic_stone_entity.triggerEvent(\"kurokumaft:west\");\r\n            }\r\n\r\n            let invent = magic_stone_entity.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n            let container = invent.container as Container;\r\n            let magic_stone = item.clone();\r\n            magic_stone.amount = 1;\r\n            container.addItem(magic_stone);\r\n\r\n        } else {\r\n            // 魔導書セット済み\r\n            if (!block.matches(block.typeId,{\"kurokumaft:book_set\":0})) {\r\n                let grimoire_entity;\r\n                let block_entitys = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n                for (let i=0; i<block_entitys.length; i++) {\r\n                    if (block_entitys[i].typeId == \"kurokumaft:grimoire_book_entity\") {\r\n                        grimoire_entity = block_entitys[i];\r\n                        break;\r\n                    }\r\n                }\r\n                if (grimoire_entity == undefined) {\r\n                    // print(\"grimoire_entityなし\");\r\n                    return;\r\n                }\r\n                let invent = grimoire_entity.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n                let container = invent.container as Container;\r\n                let grimoire_book = container.getItem(0);\r\n                if (grimoire_book == undefined) {\r\n                    return;\r\n                }\r\n                grimoire_entity.triggerEvent(\"on_breaking\");\r\n\r\n                let new_grimoire_book_entity = block.dimension.spawnEntity(\"kurokumaft:grimoire_book_entity\", {x:block.location.x+0.5,y:block.location.y+1,z:block.location.z+0.5});\r\n                let new_invent = new_grimoire_book_entity.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n                let new_container = new_invent.container as Container;\r\n                let direction = blockPer.getState(\"minecraft:cardinal_direction\");\r\n                if (direction == \"north\") {\r\n                    new_grimoire_book_entity.triggerEvent(\"kurokumaft:north\");\r\n                } else if (direction == \"south\") {\r\n                    new_grimoire_book_entity.triggerEvent(\"kurokumaft:south\");\r\n                } else if (direction == \"east\") {\r\n                    new_grimoire_book_entity.triggerEvent(\"kurokumaft:east\");\r\n                } else {\r\n                    new_grimoire_book_entity.triggerEvent(\"kurokumaft:west\");\r\n                }\r\n\r\n                let new_grimoire_book;\r\n\r\n                let lore = grimoire_book.getLore();\r\n                let remainingNum = 0;\r\n                if (lore.length > 0) {\r\n                    remainingNum = Number(lore[0].substr(3));\r\n                }\r\n\r\n                // 魔法石セット済み\r\n                if (!block.matches(block.typeId,{\"kurokumaft:stone_set\": 0})) {\r\n                    let grimoireObject = getGrimoireObjectId(grimoire_book.typeId);\r\n                    // 空以外の魔導書がセットされている場合\r\n                    if (grimoireObject != undefined) {\r\n                        let grimoireItems = grimoireObject[\"items\"];\r\n                        // 魔導書に対応するアイテムでない場合は終了\r\n                        if (!isGrimoireItemsObject(grimoireItems, item.typeId)) {\r\n                            noBookItem();\r\n                            return;\r\n                        }\r\n                        let mulVal = getGrimoireItemsMultiValue(grimoireItems, item.typeId);\r\n                        new_grimoire_book = grimoire_book;\r\n                        remainingNum = remainingNum + (item.amount * mulVal);\r\n\r\n                    // 空の魔導書の場合\r\n                    } else {\r\n                        // すべての魔導書に対応するアイテムでない場合は終了\r\n                        if (!isGrimoireAllItemsObject(item.typeId)) {\r\n                            noBookItem();\r\n                            return;\r\n                        }\r\n                        let mulVal = getGrimoireAllItemsMultiValue(item.typeId);\r\n                        remainingNum = remainingNum + (item.amount * mulVal);\r\n                        let bookId = getGrimoireAllItemsId(item.typeId);\r\n                        new_grimoire_book = new ItemStack(bookId, 1);\r\n                        let event = getGrimoireAllItemsEvent(bookId);\r\n                        new_grimoire_book_entity.triggerEvent(event);\r\n                    }\r\n\r\n                    new_grimoire_book.setLore([\"残数：\" + remainingNum]);\r\n\r\n                    new_container.setItem(0, new_grimoire_book);\r\n\r\n                    let equ = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n                    equ.setEquipment(EquipmentSlot.Mainhand);\r\n\r\n                    let magic_stone_entitys = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n                    for (let i=0; i<magic_stone_entitys.length; i++) {\r\n                        if (magic_stone_entitys[i].typeId == \"kurokumaft:magic_stone_entity\") {\r\n                            let magic_stone_en = magic_stone_entitys[i];\r\n                            let sotne_health = magic_stone_en.getComponent(EntityComponentTypes.Health) as EntityHealthComponent;\r\n                            if(sotne_health.currentValue == 1) {\r\n                                magic_stone_en.triggerEvent(\"on_breaking\");\r\n                            } else {\r\n                                magic_stone_en.applyDamage(1,{\"cause\":\"none\"} as EntityApplyDamageOptions);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        if (blockPer.getState(\"kurokumaft:book_set\") == 1) {\r\n            let grimoire_book_entity = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n            for (let i=0; i<grimoire_book_entity.length; i++) {\r\n                if (grimoire_book_entity[i].typeId == \"kurokumaft:grimoire_book_entity\") {\r\n                    block.setPermutation(blockPer.withState(\"kurokumaft:book_set\", 0));\r\n                    let pinvent = player.getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n                    let pcontainer = pinvent.container as Container;\r\n                    let invent = grimoire_book_entity[i].getComponent(EntityComponentTypes.Inventory) as EntityInventoryComponent;\r\n                    let gcontainer = invent.container as Container;\r\n                    pcontainer.setItem(player.selectedSlotIndex, gcontainer.getItem(0));\r\n                    gcontainer.clearAll();\r\n                    // print(grimoire_book_entity[i].typeId);\r\n                    grimoire_book_entity[i].triggerEvent(\"on_breaking\");\r\n                    break;\r\n                }\r\n            }\r\n        } else {\r\n\r\n            let actionForm = new ActionFormData()\r\n            .title({ translate: \"tile.kurokumaft:magic_lectern.name\" })\r\n            .body({rawtext: [\r\n                { translate: \"magic_lectern.mess.title\" },\r\n                {text : \"\\n\\n\"},\r\n                { translate: \"magic_lectern.mess.body1\" },\r\n                {text : \"\\n\\n\"},\r\n                { translate: \"magic_lectern.mess.errorInfo\" },\r\n                {text : \"\\n\"}\r\n            ]})\r\n            .button({ translate: \"magic_lectern.mess.confirm\"});\r\n\r\n            actionForm.show(player);\r\n\r\n        }\r\n        // if (blockPer.getState(\"kurokumaft:stone_set\") != 0) {\r\n        //     let magic_stone = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n        //     for (let i=0; i<magic_stone.length; i++) {\r\n        //         if (magic_stone[i].typeId == \"kurokumaft:magic_stone_entity\") {\r\n        //             let intervalNum = system.runInterval(() => {\r\n        //                 block.setPermutation(blockPer.withState(\"kurokumaft:stone_set\", 0));\r\n        //                 let pinvent = player.getComponent(EntityComponentTypes.Inventory);\r\n        //                 let pcontainer = pinvent.container;\r\n        //                 let invent = magic_stone[i].getComponent(EntityComponentTypes.Inventory);\r\n        //                 let container = invent.container;\r\n        //                 //pcontainer.setItem(player.selectedSlot, container.getItem(0));\r\n        //                 print(magic_stone[i].typeId);\r\n        //                 magic_stone[i].kill();\r\n        //             }, 2);\r\n        //             system.runTimeout(() => {\r\n        //                 system.clearRun(intervalNum);\r\n        //             }, 3);\r\n        //             break;\r\n        //         }\r\n        //     }\r\n        // }\r\n    }\r\n};\r\n\r\n// 魔導書見台破壊\r\n/**\r\n * @param {Player} player\r\n * @param {Block} block\r\n */\r\nfunction magic_lectern_break(player:Player, block:Block) {\r\n    let intervalNum = system.runInterval(() => {\r\n        let lectern_entity = block.dimension.getEntitiesAtBlockLocation({x:block.location.x,y:block.location.y+1,z:block.location.z});\r\n        for (let i=0; i<lectern_entity.length; i++) {\r\n            if (lectern_entity[i].typeId == \"kurokumaft:grimoire_book_entity\") {\r\n                lectern_entity[i].runCommand(\"kill @s\");\r\n            }\r\n            if (lectern_entity[i].typeId == \"kurokumaft:magic_stone_entity\") {\r\n                lectern_entity[i].triggerEvent(\"on_breaking\");\r\n            }\r\n        }\r\n    }, 2);\r\n    system.runTimeout(() => {\r\n        system.clearRun(intervalNum);\r\n    }, 4);\r\n\r\n};\r\n\r\nfunction noBookItem() {\r\n    world.sendMessage(\"このアイテムは対応していません\");\r\n};\r\n\r\nexport { magic_lectern, magic_lectern_break };\r\n","import {print} from \"../common/commonUtil\"\r\n\r\ninterface GrimoireBook extends Map<string, Object> {\r\n    typeId: string,\r\n    event: string,\r\n    items: Items\r\n}\r\n\r\ninterface Items extends Array<Items> {\r\n    name: string,\r\n    multiValue: number,\r\n}[]\r\n\r\n// 魔導書オブジェクト\r\nconst GrimoireBookOjects = Object.freeze({\r\n    empty: {\r\n        typeId: \"kurokumaft:grimoire_empty\",\r\n        event : \"kurokumaft:none\",\r\n        items : [\r\n            {name: \"\", multiValue: 0},\r\n        ]\r\n    },\r\n    torch: {\r\n        typeId: \"kurokumaft:grimoire_torchlight\",\r\n        event : \"kurokumaft:fire\",\r\n        items : [\r\n            {name: \"minecraft:coal\", multiValue: 1},\r\n            {name: \"minecraft:coal_block\", multiValue: 9},\r\n            {name: \"minecraft:charcoal\", multiValue: 1}\r\n        ]\r\n    },\r\n    ignited: {\r\n        typeId: \"kurokumaft:grimoire_ignited\",\r\n        event : \"kurokumaft:fire\",\r\n        items : [\r\n            {name: \"minecraft:flint\", multiValue: 1}\r\n        ]\r\n    },\r\n    water: {\r\n        typeId: \"kurokumaft:grimoire_water\",\r\n        event : \"kurokumaft:water\",\r\n        items : [\r\n            {name: \"minecraft:water_bucket\", multiValue: 10}\r\n        ]\r\n    },\r\n    mowing: {\r\n        typeId: \"kurokumaft:grimoire_mowing\",\r\n        event : \"kurokumaft:wind\",\r\n        items : [\r\n            {name: \"minecraft:shears\", multiValue: 9}\r\n        ]\r\n    },\r\n    music_sound: {\r\n        typeId: \"kurokumaft:grimoire_music_sound\",\r\n        event : \"kurokumaft:wind\",\r\n        items : [\r\n            {name: \"minecraft:music_disc_11\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_13\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_5\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_blocks\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_cat\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_chirp\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_far\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_mall\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_mellohi\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_otherside\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_pigstep\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_relic\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_stal\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_strad\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_wait\", multiValue: 10},\r\n            {name: \"minecraft:music_disc_ward\", multiValue: 10},\r\n            {name: \"minecraft:disc_fragment\", multiValue: 3},\r\n            {name: \"minecraft:disc_fragment_5\", multiValue: 5},\r\n            {name: \"minecraft:jukebox\", multiValue: 20},\r\n            {name: \"minecraft:noteblock\", multiValue: 10}\r\n        ]\r\n    },\r\n    growth: {\r\n        typeId: \"kurokumaft:grimoire_growth\",\r\n        event : \"kurokumaft:stone\",\r\n        items : [\r\n            {name: \"minecraft:bone_meal\", multiValue: 1},\r\n            {name: \"minecraft:bone_block\", multiValue: 9},\r\n            {name: \"minecraft:bone\", multiValue: 3}\r\n        ]\r\n    },\r\n    flower_garden: {\r\n        typeId: \"kurokumaft:grimoire_flower_garden\",\r\n        event : \"kurokumaft:stone\",\r\n        items : [\r\n            {name: \"minecraft:poppy\", multiValue: 1},\r\n            {name: \"minecraft:blue_orchid\", multiValue: 1},\r\n            {name: \"minecraft:allium\", multiValue: 1},\r\n            {name: \"minecraft:azure_bluet\", multiValue: 1},\r\n            {name: \"minecraft:red_tulip\", multiValue: 1},\r\n            {name: \"minecraft:orange_tulip\", multiValue: 1},\r\n            {name: \"minecraft:white_tulip\", multiValue: 1},\r\n            {name: \"minecraft:pink_tulip\", multiValue: 1},\r\n            {name: \"minecraft:oxeye_daisy\", multiValue: 1},\r\n            {name: \"minecraft:cornflower\", multiValue: 1},\r\n            {name: \"minecraft:lily_of_the_valley\", multiValue: 1},\r\n            {name: \"minecraft:double_plant\", multiValue: 4}\r\n        ]\r\n    }\r\n});\r\n\r\n/**\r\n * 魔導書名の魔導書アイテムオブジェクトを返す\r\n * @param {string} bookId\r\n */\r\nfunction getGrimoireObjectId(bookId:string) {\r\n    let grimoireKeys = Object.keys(GrimoireBookOjects) as (keyof typeof GrimoireBookOjects)[];\r\n    return grimoireKeys.find(obj => GrimoireBookOjects[obj].typeId == bookId) as unknown as GrimoireBook;\r\n};\r\n\r\n/**\r\n * 魔導書アイテムオブジェクトに対応するアイテムか判定する\r\n * @param {Items} grimoireItems\r\n * @param {String} itemName\r\n */\r\nfunction isGrimoireItemsObject(grimoireItems:Items, itemName:String) {\r\n    return grimoireItems.find(items => items.name == itemName) != undefined;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトの中から魔導書アイテムオブジェクトに対応するアイテムか判定する\r\n * @param {string} itemName\r\n */\r\nfunction isGrimoireAllItemsObject(itemName:string) {\r\n    let items = (Object.values(GrimoireBookOjects).find(obj => {\r\n        return obj.items.find(itemObj => {\r\n            return itemObj.name == itemName;\r\n        });\r\n    }));\r\n    return items != undefined;\r\n};\r\n\r\n/**\r\n * 魔導書アイテムオブジェクトに対応するアイテムの乗算値を返す\r\n * @param {Items} grimoireItems\r\n * @param {string} itemName\r\n */\r\nfunction getGrimoireItemsMultiValue(grimoireItems:Items, itemName:string) {\r\n    let item = grimoireItems.find(items => items.name == itemName) as Items;\r\n    return item.multiValue;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトの中から魔導書アイテムオブジェクトに対応するアイテムの乗算値を返す\r\n * @param {string} itemName\r\n */\r\nfunction getGrimoireAllItemsMultiValue(itemName:string) {\r\n    let retVal = 1;\r\n    Object.values(GrimoireBookOjects).forEach(obj => {\r\n        obj.items.forEach(itemObj => {\r\n            if (itemObj.name == itemName) {\r\n                retVal = itemObj.multiValue;\r\n            }\r\n        });\r\n    });\r\n    return retVal;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトの中から魔導書アイテムオブジェクトに対応するアイテムを持つIDを返す\r\n * @param {string} itemName\r\n */\r\nfunction getGrimoireAllItemsId(itemName:string) {\r\n    let obj = Object.values(GrimoireBookOjects).find(obj => {\r\n        let filObj = obj.items.find(itemObj => {\r\n            return itemObj.name == itemName;\r\n        });\r\n        return filObj;\r\n    }) as GrimoireBook;\r\n    return obj.typeId as string;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトの中からIDに対応するアイテムを持つイベントを返す\r\n * @param {string} typeId\r\n */\r\nfunction getGrimoireAllItemsEvent(typeId:string) {\r\n    let obj = Object.values(GrimoireBookOjects).find(obj => {\r\n        return obj.typeId == typeId;\r\n    }) as GrimoireBook;\r\n    return obj.event as string;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトIDに一致する魔導書名かどうか\r\n * @param {string} bookName;\r\n */\r\nfunction isGrimoireAllItemsId(bookName:string) {\r\n    return Object.values(GrimoireBookOjects).find(obj => {\r\n        return obj.typeId == bookName;\r\n    }) != undefined;\r\n};\r\n\r\n/**\r\n * 魔導書オブジェクトIDに一致する魔導書名かどうか\r\n * @param {string} bookName;\r\n */\r\nfunction getGrimoireAllObjectsId(bookName:string) {\r\n    return Object.values(GrimoireBookOjects).find(obj => {\r\n        return obj.typeId == bookName;\r\n    }) as unknown as GrimoireBook;\r\n};\r\n\r\nexport { getGrimoireObjectId, isGrimoireItemsObject, isGrimoireAllItemsObject, getGrimoireItemsMultiValue, getGrimoireAllItemsMultiValue, getGrimoireAllItemsId\r\n    , isGrimoireAllItemsId, getGrimoireAllObjectsId, getGrimoireAllItemsEvent, GrimoireBook };\r\n","import {print} from \"../common/commonUtil\"\r\n\r\ninterface MagicStoneOjects {\r\n    name: string,\r\n    state: number,\r\n    event: string\r\n}\r\n\r\n// 魔法石オブジェクト\r\nconst MagicStoneOjects = Object.freeze([\r\n    {\r\n        name: \"kurokumaft:fire_magic_stone\",\r\n        state: 1,\r\n        event : \"kurokumaft:fire\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:water_magic_stone\",\r\n        state: 2,\r\n        event : \"kurokumaft:water\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:stone_magic_stone\",\r\n        state: 3,\r\n        event : \"kurokumaft:stone\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:wind_magic_stone\",\r\n        state: 4,\r\n        event : \"kurokumaft:wind\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:lightning_magic_stone\",\r\n        state: 5,\r\n        event : \"kurokumaft:lightning\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:ice_magic_stone\",\r\n        state: 6,\r\n        event : \"kurokumaft:ice\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:ligh_magic_stone\",\r\n        state: 7,\r\n        event : \"kurokumaft:ligh\"\r\n    },\r\n    {\r\n        name: \"kurokumaft:dark_magic_stone\",\r\n        state: 8,\r\n        event : \"kurokumaft:dark\"\r\n    }\r\n]);\r\n\r\n/**\r\n * 魔法石名に一致する魔法石オブジェクトを返す\r\n * @param {string} stoneName\r\n */\r\nfunction getMagicStoneOjectByName(stoneName:string) {\r\n    return MagicStoneOjects.find(obj => obj.name == stoneName) as MagicStoneOjects;\r\n};\r\n\r\n/**\r\n * 魔法石名に一致する魔法石オブジェクトがあるか判定する\r\n * @param {string} stoneName\r\n */\r\nfunction isMagicStoneOject(stoneName:string) {\r\n    return MagicStoneOjects.find(obj => obj.name == stoneName) != undefined;\r\n};\r\n\r\nexport { getMagicStoneOjectByName, isMagicStoneOject, MagicStoneOjects };","import { system,Player,Entity,EntityComponentTypes,Vector3,EntityEquippableComponent,EquipmentSlot\r\n    ,EntityApplyDamageByProjectileOptions,EntityApplyDamageOptions } from \"@minecraft/server\";\r\nimport { print, playsound, durabilityDamage, breakItem } from \"../common/commonUtil\"\r\n\r\n// 耐久値減少\r\n/**\r\n * @param {Player} player\r\n * @param {Entity} damager\r\n * @param {Entity} projectile\r\n * @param {Vector3} hitVector\r\n */\r\nfunction magicAmor(player:Player, damager:Entity, projectile:Entity | undefined, hitVector:Vector3 | undefined) {\r\n    let equ = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n    if (!equ) {\r\n        return;\r\n    }\r\n    let chest = equ.getEquipment(EquipmentSlot.Chest);\r\n    let legs = equ.getEquipment(EquipmentSlot.Legs);\r\n    let head = equ.getEquipment(EquipmentSlot.Head);\r\n    if (chest != undefined) {\r\n        if (damager != undefined && projectile == undefined) {\r\n            if (chest.typeId == \"kurokumaft:stone_magic_chestplate\" || chest.typeId == \"kurokumaft:nether_stone_magic_chestplate\") {\r\n                let view = player.getViewDirection();\r\n                damager.applyDamage(5,{\"cause\":\"entityExplosion\"} as EntityApplyDamageOptions);\r\n                damager.runCommandAsync(\"particle minecraft:large_explosion  ~~~\");\r\n                damager.applyKnockback(Math.round(view.x)*10,Math.round(view.z)*10,10,1);\r\n            }\r\n            if (chest.typeId == \"kurokumaft:lightning_magic_chestplate\" || chest.typeId == \"kurokumaft:nether_lightning_magic_chest\") {\r\n                damager.applyDamage(5,{\"cause\":\"lightning\"} as EntityApplyDamageOptions);\r\n                damager.runCommandAsync(\"particle kurokumaft:lightning_arrow_particle ~~~\");\r\n            }\r\n        }\r\n    }\r\n    if (legs != undefined) {\r\n        if (damager != undefined && projectile == undefined) {\r\n            if (legs.typeId == \"kurokumaft:lightning_magic_leggings\" || legs.typeId == \"kurokumaft:nether_lightning_magic_leggings\") {\r\n                let location = damager.location;\r\n                // 5から15の範囲のランダムな数値を取得\r\n                let randomNum1 = Math.floor(Math.random() * (15 - 5 + 1)) + 5;\r\n                let randomNum2 = Math.floor(Math.random() * (15 - 5 + 1)) + 5;\r\n                let randomInRange1 = Math.floor(Math.random()*2) == 1 ? -randomNum1 : randomNum1;\r\n                let randomInRange2 = Math.floor(Math.random()*2) == 1 ? -randomNum2 : randomNum2;\r\n                damager.teleport({x:location.x + randomInRange1, y:location.y, z:location.z + randomInRange2},undefined);\r\n            }\r\n        }\r\n    }\r\n    if (head != undefined) {\r\n        if ((head.typeId == \"kurokumaft:lightning_magic_helmet\" || head.typeId == \"kurokumaft:nether_lightning_magic_helmet\") && projectile != undefined) {\r\n            try {\r\n                projectile.clearVelocity();\r\n                projectile.runCommand(\"particle kurokumaft:lightning_arrow_particle ~~~\");\r\n                let intervalNum = system.runInterval(() => {\r\n                    projectile.clearVelocity();\r\n                }, 5);\r\n                system.runTimeout(() => {\r\n                    system.clearRun(intervalNum);\r\n                }, 30);\r\n            } catch (error) {\r\n            }\r\n        }\r\n        if ((head.typeId == \"kurokumaft:wind_magic_helmet\" || head.typeId == \"kurokumaft:nether_wind_magic_helmet\") && projectile != undefined) {\r\n            try {\r\n                projectile.clearVelocity();\r\n                projectile.runCommand(\"particle kurokumaft:wind_arrow_particle ~~~\");\r\n                projectile.applyImpulse({x:hitVector!.x,y:hitVector!.y,z:-hitVector!.z});\r\n            } catch (error) {\r\n            }\r\n        }\r\n    }\r\n};\r\n\r\nexport { magicAmor }\r\n","import { system,Dimension,Vector3 } from \"@minecraft/server\";\r\nimport { print, playsound, durabilityDamage, breakItem } from \"../common/commonUtil\";\r\n\r\n// ファイアストーム\r\n/**\r\n * @param {Dimension} dim\r\n * @param {Vector3} locat\r\n */\r\nfunction fireStorm(dim:Dimension, locat:Vector3) {\r\n\r\n    let stand = dim.spawnEntity(\"kurokumaft:firestormmagic_stand\", locat);\r\n    stand.runCommand(\"tag @s add firestormmagic_self\");\r\n    // let intervalNum = system.runInterval(() => {\r\n    //     try {\r\n    //         dim.runCommand(\"execute positioned \" + locat.x + \" \" + locat.y + \" \" + locat.z + \" as @e[family=firestormmagic_stand,c=1] at @s run particle kurokumaft:firestome5_particle ~~~\");\r\n    //         dim.runCommand(\"execute positioned \" + locat.x + \" \" + locat.y + \" \" + locat.z + \" as @e[family=firestormmagic_stand,c=1] at @s run damage @e[family=!magic,family=!inanimate,family=!familiar,type=!item,r=5] 15 fire\");\r\n    //     } catch (error) {\r\n    //     } finally {\r\n    //     }\r\n    // }, 1);\r\n    // system.runTimeout(() => {\r\n    //     dim.runCommand(\"execute positioned \" + locat.x + \" \" + locat.y + \" \" + locat.z + \" as @e[family=firestormmagic_stand,c=1] at @s run kill @s\");\r\n    //     system.clearRun(intervalNum);\r\n    // }, 60);\r\n\r\n};\r\n\r\nexport { fireStorm };\r\n","import { ItemComponentTypes, ItemCooldownComponent, ItemStack, Player, Vector3 } from \"@minecraft/server\"\r\nimport { getAdjacentSphericalPoints } from \"../common/ShooterPoints\";\r\nimport { getRandomInRange } from \"../common/commonUtil\";\r\n\r\n/**\r\n * 投擲系魔法\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n * @param {string} throwItem\r\n * @param {Vector3} ranNum\r\n */\r\nfunction throwing(player:Player, item:ItemStack, throwItem:string, ranNum:Vector3) {\r\n\r\n    let {xapply, yapply, zapply, xlocation, ylocation, zlocation} = getAdjacentSphericalPoints(player.getRotation(), player.location);\r\n\r\n    let bulet = player.dimension.spawnEntity(throwItem, \r\n        {\r\n            x:xlocation! + ranNum.x,\r\n            y:ylocation! + ranNum.y,\r\n            z:zlocation! + ranNum.z\r\n        }\r\n    );\r\n    item.amount++;\r\n    bulet.setRotation({x:0,y:player.getRotation().y});\r\n    bulet.applyImpulse({x:xapply! * 1.5,y:yapply! * 1.5,z:zapply! * 1.5});\r\n\r\n    let cool = item.getComponent(ItemComponentTypes.Cooldown) as ItemCooldownComponent;\r\n    cool.startCooldown(player);\r\n\r\n}\r\n\r\nexport {throwing};","import { Vector2, Vector3 } from \"@minecraft/server\";\r\nimport { print } from \"./commonUtil\";\r\n\r\n/**\r\n * 弾丸発射位置\r\n * @param {Vector2} rotation\r\n * @param {Vector3} location\r\n */\r\nfunction getAdjacentSphericalPoints(rotation:Vector2, location:Vector3) {\r\n    let r = 1;  // 半径\r\n\r\n    let piNum = 75;\r\n    let xapply;\r\n    let yapply;\r\n    let zapply;\r\n    let xlocation;\r\n    let ylocation;\r\n    let zlocation;\r\n\r\n    // 西～北\r\n    if (rotation.y >= -90 && rotation.y < 0) {\r\n        let yRotax = -rotation.y / piNum;\r\n        let yRotaz = (rotation.y + 90) / piNum;\r\n        let yRota = -(rotation.x / piNum);\r\n        // 上～正面\r\n        if (rotation.x >= -90 && rotation.x < 0) {\r\n            let xRota = (rotation.x + 90) / piNum;\r\n            xlocation = location.x + (yRotax * xRota) * 1.75;\r\n            xapply = yRotax * xRota;\r\n\r\n            if (rotation.x <= -45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.5) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            zapply = yRotaz * xRota;\r\n\r\n        // 正面～下\r\n        } else if (rotation.x >= 0 && rotation.x <= 90) {\r\n            let xRota = -(rotation.x - 90) / piNum;\r\n            xlocation = location.x + (yRotax * xRota) * 1.75;\r\n            xapply = yRotax * xRota;\r\n\r\n            if (rotation.x >= 45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            zapply = yRotaz * xRota;\r\n\r\n        }\r\n\r\n    // 北～東\r\n    } else if (rotation.y >= 0 && rotation.y <= 90) {\r\n\r\n        let yRotax = rotation.y / piNum;\r\n        let yRotaz = -(rotation.y - 90) / piNum;\r\n        let yRota = -(rotation.x / piNum);\r\n        // 上～正面\r\n        if (rotation.x >= -90 && rotation.x < 0) {\r\n            let xRota = (rotation.x + 90) / piNum;\r\n\r\n            if (rotation.y >= 45) {\r\n                xlocation = location.x - (yRotax * xRota) * 1.75;\r\n            } else {\r\n                xlocation = location.x - (yRotax * xRota + 0.5) * 1.75;\r\n            }\r\n            xapply = -(yRotax * xRota);\r\n\r\n            if (rotation.x <= -45) {\r\n                ylocation = (location.y + 1.75) + (yRota) * 1.25;\r\n            } else {\r\n                ylocation = (location.y + 1.5) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            if (rotation.y >= 45) {\r\n                zlocation = location.z + (yRotaz * xRota - 0.5) * 1.75;\r\n            } else {\r\n                zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            }\r\n\r\n            zapply = yRotaz * xRota;\r\n\r\n        // 正面～下\r\n        } else if (rotation.x >= 0 && rotation.x <= 90) {\r\n            let xRota = -(rotation.x - 90) / piNum;\r\n            if (rotation.y >= 45) {\r\n                xlocation = location.x - (yRotax * xRota) * 1.75;\r\n            } else {\r\n                xlocation = location.x - (yRotax * xRota + 0.5) * 1.75;\r\n            }\r\n            xapply = -(yRotax * xRota);\r\n\r\n            if (rotation.x >= 45) {\r\n                ylocation = (location.y + 1.75) + (yRota) * 1.25;\r\n            } else {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            if (rotation.y >= 45) {\r\n                zlocation = location.z + (yRotaz * xRota - 0.5) * 1.75;\r\n            } else {\r\n                zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            }\r\n            zapply = yRotaz * xRota;\r\n\r\n        }\r\n\r\n    // 西～南\r\n    } else if (rotation.y < -90 && rotation.y > -180) {\r\n\r\n        let yRotax = (rotation.y + 180) / piNum;\r\n        let yRotaz = (rotation.y + 90) / piNum;\r\n        let yRota = -(rotation.x / piNum);\r\n        // 上～正面\r\n        if (rotation.x >= -90 && rotation.x < 0) {\r\n            let xRota = (rotation.x + 90) / piNum;\r\n            xlocation = location.x + (yRotax * xRota) * 1.75;\r\n            xapply = yRotax * xRota;\r\n\r\n            if (rotation.x <= -45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.5) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            zapply = yRotaz * xRota;\r\n\r\n        // 正面～下\r\n        } else if (rotation.x >= 0 && rotation.x <= 90) {\r\n            let xRota = -(rotation.x - 90) / piNum;\r\n            xlocation = location.x + (yRotax * xRota) * 1.75;\r\n            xapply = yRotax * xRota;\r\n\r\n            if (rotation.x >= 45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            zapply = yRotaz * xRota;\r\n\r\n        }\r\n\r\n    // 東～南\r\n    } else if (rotation.y > 90 && rotation.y <= 180) {\r\n        let yRotax = -(rotation.y - 180) / piNum;\r\n        let yRotaz = -(rotation.y - 90) / piNum;\r\n        let yRota = -(rotation.x / piNum);\r\n        // 上～正面\r\n        if (rotation.x >= -90 && rotation.x < 0) {\r\n            let xRota = (rotation.x + 90) / piNum;\r\n            xlocation = location.x - (yRotax * xRota) * 1.75;\r\n            xapply = -(yRotax * xRota);\r\n\r\n            if (rotation.x <= -45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.5) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            if (rotation.y <= 135) {\r\n                zlocation = location.z + (yRotaz * xRota - 0.5) * 1.75;\r\n            } else {\r\n                zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            }\r\n\r\n            zapply = yRotaz * xRota;\r\n\r\n        // 正面～下\r\n        } else if (rotation.x >= 0 && rotation.x <= 90) {\r\n            let xRota = -(rotation.x - 90) / piNum;\r\n            xlocation = location.x - (yRotax * xRota) * 1.75;\r\n            xapply = -(yRotax * xRota);\r\n\r\n            if (rotation.x >= 45) {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.5;\r\n            } else {\r\n                ylocation = (location.y + 1.25) + (yRota) * 1.25;\r\n            }\r\n            yapply = (yRota);\r\n\r\n            if (rotation.y <= 135) {\r\n                zlocation = location.z + (yRotaz * xRota - 0.5) * 1.75;\r\n            } else {\r\n                zlocation = location.z + (yRotaz * xRota) * 1.75;\r\n            }\r\n            zapply = yRotaz * xRota;\r\n\r\n        }\r\n\r\n    }\r\n    return { xapply, yapply, zapply, xlocation, ylocation, zlocation };\r\n}\r\n\r\nexport { getAdjacentSphericalPoints }\r\n","import { ItemCustomComponent,ItemComponentBeforeDurabilityDamageEvent, ItemComponentUseEvent, ItemStack, Player, ItemComponent, ItemComponentTypes, ItemDurabilityComponent, Entity, EntityEquippableComponent, EntityComponentTypes, EquipmentSlot } from \"@minecraft/server\";\r\nimport { print,getRandomInRange } from \"./commonUtil\";\r\n\r\n/**\r\n * アイテムダメージ\r\n * @param {Player} player\r\n * @param {ItemStack} item\r\n */\r\nasync function ItemDurabilityDamageEvent(player:Player, item:ItemStack) {\r\n\r\n    let equ = player.getComponent(EntityComponentTypes.Equippable) as EntityEquippableComponent;\r\n\r\n    let durability = item.getComponent(ItemComponentTypes.Durability) as ItemDurabilityComponent;\r\n    print(durability.damage+\"\");\r\n    let damageRan = parseFloat(getRandomInRange(durability.getDamageChanceRange().min, durability.getDamageChanceRange().max).toFixed(3));\r\n    print(damageRan+\"\");\r\n    let dChange = durability.getDamageChance(damageRan);\r\n    print(dChange+\"\");\r\n\r\n    durability.damage = durability.damage + dChange;\r\n    print(durability.damage+\"\");\r\n\r\n    equ.setEquipment(EquipmentSlot.Mainhand, item);\r\n}\r\n\r\nexport {ItemDurabilityDamageEvent};","import { ItemComponent, ItemComponentTypes, ItemComponentUseEvent, ItemCooldownComponent, ItemCustomComponent, ItemStack, Player } from \"@minecraft/server\";\r\nimport { throwing } from \"../../custom/ShooterMagicEvent\";\r\nimport { getRandomInRange } from \"../../common/commonUtil\";\r\nimport { ItemDurabilityDamageEvent } from \"../../common/ItemDurabilityDamage\";\r\n\r\n/**\r\n * ファイアボール\r\n */\r\nexport class FireBallShot implements ItemCustomComponent {\r\n\r\n    onUse(event:ItemComponentUseEvent) {\r\n        let itemStack = event.itemStack as ItemStack;\r\n        let player = event.source as Player;\r\n\r\n        let xran = parseFloat(getRandomInRange(-0.1, 0.5).toFixed(3));\r\n        let yran = parseFloat(getRandomInRange(-0.1, 0.1).toFixed(3));\r\n        let zran = parseFloat(getRandomInRange(-0.1, 0.1).toFixed(3));\r\n\r\n        ItemDurabilityDamageEvent(player, itemStack);\r\n        throwing(player, itemStack, \"kurokumaft:fireballmagic\", {x:xran,y:yran,z:zran});\r\n\r\n    }\r\n\r\n}","import { WorldInitializeBeforeEvent } from \"@minecraft/server\";\r\nimport { FireBallShot } from \"../weapon/wand/FireMagicWand\";\r\n\r\n/**\r\n * カスタムコンポーネントの登録\r\n * @param {WorldInitializeBeforeEvent} initEvent\r\n */\r\nfunction registerCustomComponentFunction(initEvent:WorldInitializeBeforeEvent) {\r\n\r\n    initEvent.itemComponentRegistry.registerCustomComponent('kurokumaft:fire_ball', new FireBallShot());\r\n  \r\n}\r\n\r\nexport {registerCustomComponentFunction}\r\n"],"mappings":"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","names":["world","system","EntityComponentTypes","ItemComponentTypes","EquipmentSlot","EntityComponentTypes","EquipmentSlot","ItemComponentTypes","EntityComponentTypes","EquipmentSlot","system","world","system","EntityComponentTypes","ItemStack","ItemComponentTypes","world","ItemComponentTypes","system","system","system","ItemComponentTypes","EntityComponentTypes","ItemStack","ItemComponentTypes","system","EntityComponentTypes","ItemStack","system","world","EntityComponentTypes","ItemStack","EquipmentSlot","system","system","EntityComponentTypes","EquipmentSlot","ItemComponentTypes","ItemComponentTypes","ItemComponentTypes","EntityComponentTypes","EquipmentSlot","EntityComponentTypes","ItemComponentTypes","EquipmentSlot","world"],"file":"../scripts/magic_script.js"}